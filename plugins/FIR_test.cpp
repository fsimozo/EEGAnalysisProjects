/* 
 * File:   FIR_test.cpp
 * Author: Fabricio
 * 
 * Created on 7 de Janeiro de 2013, 12:52
 */

#include "FIR_test.h"

#include <QtGui>

#include <math.h>
#include <stdlib.h>
#include <stdio.h>

QCheckBox *check1 = new QCheckBox("100-500Hz");
QCheckBox *check2 = new QCheckBox("80-200Hz");
QCheckBox *check3 = new QCheckBox("200-500Hz");

QStringList FIR_test::methods() const{
    return QStringList() <<tr("FIR test");
}

QString FIR_test::description() const{
    QString description = "Uses a specific FIR filter on the signal";
    return description;
}

int FIR_test::numberofdata() const{
    int number = n_results;
    return number;
}

int* FIR_test::elementsonch() const{
    int* number = n_elements;
    return number;
}

QStringList FIR_test::name() const{
    QStringList name;
    name.append("100-500Hz Filter");
    name.append("80-200Hz Filter");
    name.append("200-500Hz Filter");
    return name;
}

QWidget* FIR_test::parameters() const{
    QWidget *page = new QWidget();
    QVBoxLayout *layout = new QVBoxLayout();
    layout->addWidget(check1);
    layout->addWidget(check2);
    layout->addWidget(check3);
    page->setLayout(layout);
    return page;
}

double*** FIR_test::analysis(QVector<double> X, QVector<double> Y){
    //Defines the filters that may be used
    // <editor-fold defaultstate="collapsed" desc="Impulse response - FIR 100-500Hz">
    double filter[] = {
        0.0025455954868606103,
        0.0008115350852820993,
        0.000544962755701732,
        0.000044615561918193995,
        -0.0005554021557256003,
        -0.0010709311619624862,
        -0.0013305620604878061,
        -0.001240264599680761,
        -0.0008249295705142526,
        -0.00022825333163882134,
        0.0003326768628305232,
        0.000644325009631141,
        0.0005789044174916631,
        0.00014719139065365284,
        -0.0004931144367299614,
        -0.001095767622722515,
        -0.0014087218772028509,
        -0.0012803247130582424,
        -0.0007225160619710513,
        0.00008285425942820043,
        0.0008412118077665363,
        0.001254493112126455,
        0.0011397977745764203,
        0.0005090922638695489,
        -0.0004220287306217376,
        -0.0013043304908694098,
        -0.0017825564502564712,
        -0.0016364704663009502,
        -0.0008763490101097674,
        0.0002437761187108549,
        0.0013113101585913527,
        0.0019053699816997535,
        0.0017622026002303902,
        0.000890223206701688,
        -0.00041521752713307076,
        -0.001668399144408441,
        -0.0023716902594792867,
        -0.0022108718223087217,
        -0.001190629543545577,
        0.0003465213941107214,
        0.0018326819823465852,
        0.00268240009261838,
        0.002522140427930134,
        0.0013501896002882222,
        -0.0004381872797808556,
        -0.0021805425644243837,
        -0.0031898232281722307,
        -0.0030222959135624027,
        -0.001667624572828945,
        0.0004195723081384234,
        0.0024683497013942186,
        0.0036735807579422633,
        0.003509274315810313,
        0.0019526345351432413,
        -0.0004747127911449199,
        -0.002876514891885717,
        -0.004309060935151889,
        -0.004148152462424222,
        -0.0023538122169757705,
        0.00047635992124382454,
        0.003300151199104669,
        0.005010185888652734,
        0.0048631278229526904,
        0.002794653310178627,
        -0.0005113016139305214,
        -0.003840336576181834,
        -0.005887602475503444,
        -0.005762310769798208,
        -0.003364484249494004,
        0.0005218368204415384,
        0.004474495117444705,
        0.006945413517045414,
        0.006857660559536416,
        0.004059898171829435,
        -0.0005473731434410583,
        -0.0052869550990193685,
        -0.008304159602852176,
        -0.008277891605520393,
        -0.004978611247050748,
        0.0005577524065152653,
        0.00633300789260961,
        0.01008919132711826,
        0.010169397876821949,
        0.006216314842319142,
        -0.0005752069823643523,
        -0.007785073603876523,
        -0.01259877686529034,
        -0.0128688416356595,
        -0.00801660652230617,
        0.0005852195493140854,
        0.009939053910091153,
        0.016412111149615823,
        0.01706867605518215,
        0.010889788923515026,
        -0.0005956757341087803,
        -0.013564333817298166,
        -0.023045910647602603,
        -0.024647825687012632,
        -0.01629948320317819,
        0.000600272487082662,
        0.02109258316924396,
        0.037765670288583485,
        0.0428281620078241,
        0.030572421704800772,
        -0.0006056070146837346,
        -0.04718285822160479,
        -0.10099846627308083,
        -0.15111184647130402,
        -0.18658659788210954,
        0.8006067705544962,
        -0.18658659788210954,
        -0.15111184647130402,
        -0.10099846627308083,
        -0.04718285822160479,
        -0.0006056070146837346,
        0.030572421704800772,
        0.0428281620078241,
        0.037765670288583485,
        0.02109258316924396,
        0.000600272487082662,
        -0.01629948320317819,
        -0.024647825687012632,
        -0.023045910647602603,
        -0.013564333817298166,
        -0.0005956757341087803,
        0.010889788923515026,
        0.01706867605518215,
        0.016412111149615823,
        0.009939053910091153,
        0.0005852195493140854,
        -0.00801660652230617,
        -0.0128688416356595,
        -0.01259877686529034,
        -0.007785073603876523,
        -0.0005752069823643523,
        0.006216314842319142,
        0.010169397876821949,
        0.01008919132711826,
        0.00633300789260961,
        0.0005577524065152653,
        -0.004978611247050748,
        -0.008277891605520393,
        -0.008304159602852176,
        -0.0052869550990193685,
        -0.0005473731434410583,
        0.004059898171829435,
        0.006857660559536416,
        0.006945413517045414,
        0.004474495117444705,
        0.0005218368204415384,
        -0.003364484249494004,
        -0.005762310769798208,
        -0.005887602475503444,
        -0.003840336576181834,
        -0.0005113016139305214,
        0.002794653310178627,
        0.0048631278229526904,
        0.005010185888652734,
        0.003300151199104669,
        0.00047635992124382454,
        -0.0023538122169757705,
        -0.004148152462424222,
        -0.004309060935151889,
        -0.002876514891885717,
        -0.0004747127911449199,
        0.0019526345351432413,
        0.003509274315810313,
        0.0036735807579422633,
        0.0024683497013942186,
        0.0004195723081384234,
        -0.001667624572828945,
        -0.0030222959135624027,
        -0.0031898232281722307,
        -0.0021805425644243837,
        -0.0004381872797808556,
        0.0013501896002882222,
        0.002522140427930134,
        0.00268240009261838,
        0.0018326819823465852,
        0.0003465213941107214,
        -0.001190629543545577,
        -0.0022108718223087217,
        -0.0023716902594792867,
        -0.001668399144408441,
        -0.00041521752713307076,
        0.000890223206701688,
        0.0017622026002303902,
        0.0019053699816997535,
        0.0013113101585913527,
        0.0002437761187108549,
        -0.0008763490101097674,
        -0.0016364704663009502,
        -0.0017825564502564712,
        -0.0013043304908694098,
        -0.0004220287306217376,
        0.0005090922638695489,
        0.0011397977745764203,
        0.001254493112126455,
        0.0008412118077665363,
        0.00008285425942820043,
        -0.0007225160619710513,
        -0.0012803247130582424,
        -0.0014087218772028509,
        -0.001095767622722515,
        -0.0004931144367299614,
        0.00014719139065365284,
        0.0005789044174916631,
        0.000644325009631141,
        0.0003326768628305232,
        -0.00022825333163882134,
        -0.0008249295705142526,
        -0.001240264599680761,
        -0.0013305620604878061,
        -0.0010709311619624862,
        -0.0005554021557256003,
        0.000044615561918193995,
        0.000544962755701732,
        0.0008115350852820993,
        0.0025455954868606103
    }; // </editor-fold>

    // <editor-fold defaultstate="collapsed" desc="Impulse response - FIR 80-200Hz">
    double filter1[] = {
        0.0006242311614695328,
        -0.0001947261757557327,
        -0.0006082282656239135,
        0.004371810904599041,
        0.0005699728966971196,
        0.0004165966131283616,
        -0.0001587276121846208,
        0.0006944928926782126,
        0.0005288803229584008,
        -0.00041539198430875325,
        -0.0015331599829443779,
        -0.001431222500267898,
        -0.0002692699803814782,
        0.0006365323081881792,
        0.00038843511987733534,
        -0.0002038211934371512,
        0.0001958882735551435,
        0.0014590715053331247,
        0.0019440941459200267,
        0.0006912419931430629,
        -0.0011130850367528297,
        -0.0015721455418476618,
        -0.000599157881785124,
        -0.000007943155968371554,
        -0.0009025302785771288,
        -0.001952531967188622,
        -0.001140780424350181,
        0.0012789192498170534,
        0.002799987195434832,
        0.0018961847290908187,
        0.00008829805936532681,
        -0.00014670829229373767,
        0.001115703106073228,
        0.0012719466909707283,
        -0.0010389209803422365,
        -0.0036293096238672945,
        -0.003421876075978666,
        -0.0006241149964364047,
        0.0014193885636438952,
        0.000716997514639281,
        -0.0006382244699848402,
        0.0005033270369921974,
        0.003570732634335106,
        0.004605461747141894,
        0.0015926228285320153,
        -0.002474702530108923,
        -0.0033232446833282346,
        -0.0010991272863238107,
        -0.00004332903414959188,
        -0.002340711675840411,
        -0.004675988934906307,
        -0.0026255138436870147,
        0.002849568645273694,
        0.006053519536666393,
        0.003932583030252603,
        0.0001661836638967882,
        0.00004247241740566812,
        0.002924462738116324,
        0.00299064569380827,
        -0.0023389383190874774,
        -0.007955963977536966,
        -0.007312464749880869,
        -0.0012898721220150854,
        0.0027609376124207267,
        0.0009643743062296216,
        -0.0017594033965335684,
        0.0011871301426704427,
        0.008044098877012856,
        0.01010874708214772,
        0.0034193359086007705,
        -0.005174926366049029,
        -0.0066635489951324504,
        -0.0018862101101559407,
        -0.00013875424565182567,
        -0.005668088529300368,
        -0.010754335189664316,
        -0.005897254913259787,
        0.006285198603645647,
        0.01311225799684884,
        0.008275233560181,
        0.00032308914796267313,
        0.0007743325374715055,
        0.0075506573024202595,
        0.007258500142214241,
        -0.00555168041600952,
        -0.01866163180876743,
        -0.01697687405966199,
        -0.0029478313634949426,
        0.006014251902993386,
        0.0011383475536263974,
        -0.005169258112541563,
        0.0031972455626813065,
        0.021348522269553392,
        0.02675501833940197,
        0.00906885046825504,
        -0.0137051997604186,
        -0.01734090317794161,
        -0.004164493259044136,
        -0.0005335890347147142,
        -0.018929175776805505,
        -0.03579847825766233,
        -0.020016399979191215,
        0.021944651770885514,
        0.04733633247767172,
        0.030728601631083857,
        0.001166944542809524,
        0.006357165108585506,
        0.04220017101663777,
        0.043226347599704,
        -0.03720748594440716,
        -0.14750429857464,
        -0.1685442492329193,
        -0.04097458938419488,
        0.1500800339947785,
        0.24120071970606272,
        0.1500800339947785,
        -0.04097458938419488,
        -0.1685442492329193,
        -0.14750429857464,
        -0.03720748594440716,
        0.043226347599704,
        0.04220017101663777,
        0.006357165108585506,
        0.001166944542809524,
        0.030728601631083857,
        0.04733633247767172,
        0.021944651770885514,
        -0.020016399979191215,
        -0.03579847825766233,
        -0.018929175776805505,
        -0.0005335890347147142,
        -0.004164493259044136,
        -0.01734090317794161,
        -0.0137051997604186,
        0.00906885046825504,
        0.02675501833940197,
        0.021348522269553392,
        0.0031972455626813065,
        -0.005169258112541563,
        0.0011383475536263974,
        0.006014251902993386,
        -0.0029478313634949426,
        -0.01697687405966199,
        -0.01866163180876743,
        -0.00555168041600952,
        0.007258500142214241,
        0.0075506573024202595,
        0.0007743325374715055,
        0.00032308914796267313,
        0.008275233560181,
        0.01311225799684884,
        0.006285198603645647,
        -0.005897254913259787,
        -0.010754335189664316,
        -0.005668088529300368,
        -0.00013875424565182567,
        -0.0018862101101559407,
        -0.0066635489951324504,
        -0.005174926366049029,
        0.0034193359086007705,
        0.01010874708214772,
        0.008044098877012856,
        0.0011871301426704427,
        -0.0017594033965335684,
        0.0009643743062296216,
        0.0027609376124207267,
        -0.0012898721220150854,
        -0.007312464749880869,
        -0.007955963977536966,
        -0.0023389383190874774,
        0.00299064569380827,
        0.002924462738116324,
        0.00004247241740566812,
        0.0001661836638967882,
        0.003932583030252603,
        0.006053519536666393,
        0.002849568645273694,
        -0.0026255138436870147,
        -0.004675988934906307,
        -0.002340711675840411,
        -0.00004332903414959188,
        -0.0010991272863238107,
        -0.0033232446833282346,
        -0.002474702530108923,
        0.0015926228285320153,
        0.004605461747141894,
        0.003570732634335106,
        0.0005033270369921974,
        -0.0006382244699848402,
        0.000716997514639281,
        0.0014193885636438952,
        -0.0006241149964364047,
        -0.003421876075978666,
        -0.0036293096238672945,
        -0.0010389209803422365,
        0.0012719466909707283,
        0.001115703106073228,
        -0.00014670829229373767,
        0.00008829805936532681,
        0.0018961847290908187,
        0.002799987195434832,
        0.0012789192498170534,
        -0.001140780424350181,
        -0.001952531967188622,
        -0.0009025302785771288,
        -0.000007943155968371554,
        -0.000599157881785124,
        -0.0015721455418476618,
        -0.0011130850367528297,
        0.0006912419931430629,
        0.0019440941459200267,
        0.0014590715053331247,
        0.0001958882735551435,
        -0.0002038211934371512,
        0.00038843511987733534,
        0.0006365323081881792,
        -0.0002692699803814782,
        -0.001431222500267898,
        -0.0015331599829443779,
        -0.00041539198430875325,
        0.0005288803229584008,
        0.0006944928926782126,
        -0.0001587276121846208,
        0.0004165966131283616,
        0.0005699728966971196,
        0.004371810904599041,
        -0.0006082282656239135,
        -0.0001947261757557327,
        0.0006242311614695328
    }; // </editor-fold>

    // <editor-fold defaultstate="collapsed" desc="Impulse response - FIR 200-500Hz">
    double filter2[] = {
        0.0020202329963214345,
        0.002997985392477294,
        0.00022893865099389031,
        -0.00005087352667235265,
        -0.0011005279470757297,
        0.00024176731339881966,
        0.0007014250277915424,
        0.0004676541481535436,
        -0.0006727530645702464,
        -0.0007580505740436576,
        0.0001590310440551168,
        0.0009696550009364135,
        0.0004017819157826842,
        -0.0007624452573040596,
        -0.0009341630508709889,
        0.00023290659241758486,
        0.0011477974778255956,
        0.0004913834000446164,
        -0.0009209232636754081,
        -0.0011191334601865454,
        0.00026670624050657285,
        0.0013745803907431941,
        0.0005995899020551937,
        -0.001086931141980093,
        -0.0013436147425602996,
        0.00029934312305919975,
        0.0016327218926637233,
        0.0007322111486456576,
        -0.0012741410505423812,
        -0.0016052879767645466,
        0.00032850531114027976,
        0.0019259388318018111,
        0.0008906273275480895,
        -0.0014837455105886352,
        -0.0019051075305466568,
        0.00035597522867444095,
        0.0022618431282377498,
        0.0010752558508036669,
        -0.0017192025471074372,
        -0.0022514075702647013,
        0.00038371228147839325,
        0.002644776353321546,
        0.001291320987404742,
        -0.0019858327520522385,
        -0.0026500979126152405,
        0.0004101824850506776,
        0.003083857648397851,
        0.0015439681390159417,
        -0.002288025156945546,
        -0.0031121254524179476,
        0.00043577879527431954,
        0.003589331815891963,
        0.0018411388432850275,
        -0.002635224372799742,
        -0.0036508372324879556,
        0.0004597942725392853,
        0.004178212181909993,
        0.0021938628099154155,
        -0.003037457947398188,
        -0.004285622653971441,
        0.0004820660711288466,
        0.004872458399267198,
        0.0026162100127118905,
        -0.0035111602154214785,
        -0.005044392661271154,
        0.0005034290416812187,
        0.00570430662600214,
        0.003129788031631433,
        -0.0040798693146792036,
        -0.005968188267548852,
        0.0005232567441953939,
        0.006723035036680841,
        0.003768587126763901,
        -0.004779324821724662,
        -0.007123625660762061,
        0.0005404798353825407,
        0.00800746958543898,
        0.004587354242729933,
        -0.0056698609672892345,
        -0.00861717310235943,
        0.0005568200037369724,
        0.009692833605331642,
        0.005677579885724839,
        -0.006855695301541545,
        -0.01063898852379343,
        0.0005709116427226227,
        0.012021920259394511,
        0.007212945238357561,
        -0.008534000013276857,
        -0.013560459845799885,
        0.0005814165979496928,
        0.015499403519569025,
        0.009560728487974787,
        -0.011139365017015554,
        -0.01821927307606846,
        0.0005901839025856314,
        0.021350553219757956,
        0.013647981258665598,
        -0.01583330457292812,
        -0.026979461864211386,
        0.0005951072027494313,
        0.03352605639124943,
        0.022741396106565833,
        -0.027071079469419286,
        -0.05007236779340316,
        0.0006015320192864228,
        0.07573673745886181,
        0.06181692804854635,
        -0.09399606211295493,
        -0.30251114931244383,
        0.6006037433659575,
        -0.30251114931244383,
        -0.09399606211295493,
        0.06181692804854635,
        0.07573673745886181,
        0.0006015320192864228,
        -0.05007236779340316,
        -0.027071079469419286,
        0.022741396106565833,
        0.03352605639124943,
        0.0005951072027494313,
        -0.026979461864211386,
        -0.01583330457292812,
        0.013647981258665598,
        0.021350553219757956,
        0.0005901839025856314,
        -0.01821927307606846,
        -0.011139365017015554,
        0.009560728487974787,
        0.015499403519569025,
        0.0005814165979496928,
        -0.013560459845799885,
        -0.008534000013276857,
        0.007212945238357561,
        0.012021920259394511,
        0.0005709116427226227,
        -0.01063898852379343,
        -0.006855695301541545,
        0.005677579885724839,
        0.009692833605331642,
        0.0005568200037369724,
        -0.00861717310235943,
        -0.0056698609672892345,
        0.004587354242729933,
        0.00800746958543898,
        0.0005404798353825407,
        -0.007123625660762061,
        -0.004779324821724662,
        0.003768587126763901,
        0.006723035036680841,
        0.0005232567441953939,
        -0.005968188267548852,
        -0.0040798693146792036,
        0.003129788031631433,
        0.00570430662600214,
        0.0005034290416812187,
        -0.005044392661271154,
        -0.0035111602154214785,
        0.0026162100127118905,
        0.004872458399267198,
        0.0004820660711288466,
        -0.004285622653971441,
        -0.003037457947398188,
        0.0021938628099154155,
        0.004178212181909993,
        0.0004597942725392853,
        -0.0036508372324879556,
        -0.002635224372799742,
        0.0018411388432850275,
        0.003589331815891963,
        0.00043577879527431954,
        -0.0031121254524179476,
        -0.002288025156945546,
        0.0015439681390159417,
        0.003083857648397851,
        0.0004101824850506776,
        -0.0026500979126152405,
        -0.0019858327520522385,
        0.001291320987404742,
        0.002644776353321546,
        0.00038371228147839325,
        -0.0022514075702647013,
        -0.0017192025471074372,
        0.0010752558508036669,
        0.0022618431282377498,
        0.00035597522867444095,
        -0.0019051075305466568,
        -0.0014837455105886352,
        0.0008906273275480895,
        0.0019259388318018111,
        0.00032850531114027976,
        -0.0016052879767645466,
        -0.0012741410505423812,
        0.0007322111486456576,
        0.0016327218926637233,
        0.00029934312305919975,
        -0.0013436147425602996,
        -0.001086931141980093,
        0.0005995899020551937,
        0.0013745803907431941,
        0.00026670624050657285,
        -0.0011191334601865454,
        -0.0009209232636754081,
        0.0004913834000446164,
        0.0011477974778255956,
        0.00023290659241758486,
        -0.0009341630508709889,
        -0.0007624452573040596,
        0.0004017819157826842,
        0.0009696550009364135,
        0.0001590310440551168,
        -0.0007580505740436576,
        -0.0006727530645702464,
        0.0004676541481535436,
        0.0007014250277915424,
        0.00024176731339881966,
        -0.0011005279470757297,
        -0.00005087352667235265,
        0.00022893865099389031,
        0.002997985392477294,
        0.0020202329963214345
    }; // </editor-fold>

    // <editor-fold defaultstate="collapsed" desc="Impulse response - FIR 100-500Hz - Matlab">
    double filtermatlab[] = {
        0.0001516192,
        0.0002499311,
        0.0002560462,
        0.0001629841,
        -0.0000000000,
        -0.0001754498,
        -0.0002964752,
        -0.0003107983,
        -0.0002020346,
        -0.0000000000,
        0.0002253475,
        0.0003863353,
        0.0004100187,
        0.0002692894,
        0.0000000000,
        -0.0003049226,
        -0.0005254335,
        -0.0005597164,
        -0.0003685203,
        -0.0000000000,
        0.0004180777,
        0.0007202037,
        0.0007664548,
        0.0005038704,
        0.0000000000,
        -0.0005691525,
        -0.0009778473,
        -0.0010376303,
        -0.0006800421,
        -0.0000000000,
        0.0007631468,
        0.0013067267,
        0.0013819021,
        0.0009025865,
        0.0000000000,
        -0.0010060647,
        -0.0017169730,
        -0.0018098545,
        -0.0011783501,
        -0.0000000000,
        0.0013054486,
        0.0022214308,
        0.0023350314,
        0.0015161762,
        -0.0000000000,
        -0.0016712229,
        -0.0028371588,
        -0.0029755886,
        -0.0019280289,
        0.0000000000,
        0.0021170655,
        0.0035878862,
        0.0037570156,
        0.0024308619,
        0.0000000000,
        -0.0026627231,
        -0.0045081943,
        -0.0047168134,
        -0.0030498589,
        -0.0000000000,
        0.0033381109,
        0.0056510045,
        0.0059129688,
        0.0038243762,
        0.0000000000,
        -0.0041910288,
        -0.0071018698,
        -0.0074403667,
        -0.0048196309,
        -0.0000000000,
        0.0053028516,
        0.0090085630,
        0.0094654184,
        0.0061518615,
        -0.0000000000,
        -0.0068238141,
        -0.0116492230,
        -0.0123078753,
        -0.0080494069,
        -0.0000000000,
        0.0090639760,
        0.0156140224,
        0.0166669510,
        0.0110282618,
        0.0000000000,
        -0.0127790568,
        -0.0224059631,
        -0.0244126365,
        -0.0165463418,
        -0.0000000000,
        0.0204089480,
        0.0372944631,
        0.0427681362,
        0.0309289015,
        0.0000000000,
        -0.0466048021,
        -0.1007042226,
        -0.1512279507,
        -0.1870553889,
        0.8000000000,
        -0.1870553889,
        -0.1512279507,
        -0.1007042226,
        -0.0466048021,
        0.0000000000,
        0.0309289015,
        0.0427681362,
        0.0372944631,
        0.0204089480,
        -0.0000000000,
        -0.0165463418,
        -0.0244126365,
        -0.0224059631,
        -0.0127790568,
        0.0000000000,
        0.0110282618,
        0.0166669510,
        0.0156140224,
        0.0090639760,
        -0.0000000000,
        -0.0080494069,
        -0.0123078753,
        -0.0116492230,
        -0.0068238141,
        -0.0000000000,
        0.0061518615,
        0.0094654184,
        0.0090085630,
        0.0053028516,
        -0.0000000000,
        -0.0048196309,
        -0.0074403667,
        -0.0071018698,
        -0.0041910288,
        0.0000000000,
        0.0038243762,
        0.0059129688,
        0.0056510045,
        0.0033381109,
        -0.0000000000,
        -0.0030498589,
        -0.0047168134,
        -0.0045081943,
        -0.0026627231,
        0.0000000000,
        0.0024308619,
        0.0037570156,
        0.0035878862,
        0.0021170655,
        0.0000000000,
        -0.0019280289,
        -0.0029755886,
        -0.0028371588,
        -0.0016712229,
        -0.0000000000,
        0.0015161762,
        0.0023350314,
        0.0022214308,
        0.0013054486,
        -0.0000000000,
        -0.0011783501,
        -0.0018098545,
        -0.0017169730,
        -0.0010060647,
        0.0000000000,
        0.0009025865,
        0.0013819021,
        0.0013067267,
        0.0007631468,
        -0.0000000000,
        -0.0006800421,
        -0.0010376303,
        -0.0009778473,
        -0.0005691525,
        0.0000000000,
        0.0005038704,
        0.0007664548,
        0.0007202037,
        0.0004180777,
        -0.0000000000,
        -0.0003685203,
        -0.0005597164,
        -0.0005254335,
        -0.0003049226,
        0.0000000000,
        0.0002692894,
        0.0004100187,
        0.0003863353,
        0.0002253475,
        -0.0000000000,
        -0.0002020346,
        -0.0003107983,
        -0.0002964752,
        -0.0001754498,
        -0.0000000000,
        0.0001629841,
        0.0002560462,
        0.0002499311,
        0.0001516192,
        0.0000000000,
        -0.0001486168
    }; // </editor-fold>

    double*** result;// = new QVector<>;
    //3 possible filters
    result = new double**[3];
    for(int i = 0; i<3; i++){
        //X and Y axis
        result[i] = new double*[2];
        //X axis - index 0
        result[i][0] = new double[X.count()];
        //Y axis - index 1
        result[i][1] = new double[X.count()];
    }
    
    n_results = 0;
    if(check1->isChecked()){
        //Calculates de convolution
        //Calculates autocorrelation function
        QVector<double> filtered;
        filtered.resize(Y.count());

        for(int i = 0; i<Y.count(); i++){
            filtered[i]=0;
            for(int j = 0; j<201; j++){
                if((i-j)>=0){
                    filtered[i]+=filtermatlab[j]*Y[i-j];
                }
            }
        }
        //Sets result as filtered signal
        for(int i = 0; i<X.count(); i++){
            result[n_results][0][i]=i;
            result[n_results][1][i]=filtered[i];
        }
        n_results++;
    }
    if(check2->isChecked()){
        //Calculates de convolution
        //Calculates autocorrelation function
        QVector<double> filtered;
        filtered.resize(Y.count());

        for(int i = 0; i<Y.count(); i++){
            filtered[i]=0;
            for(int j = 0; j<219; j++){
                if((i-j)>=0){
                    filtered[i]+=filter1[j]*Y[i-j];
                }
            }
        }
        //Sets result as filtered signal
        for(int i = 0; i<X.count(); i++){
            result[n_results][0][i]=i;
            result[n_results][1][i]=filtered[i];
        }
        n_results++;
    }
    if(check3->isChecked()){
        //Calculates de convolution
        //Calculates autocorrelation function
        QVector<double> filtered;
        filtered.resize(Y.count());

        for(int i = 0; i<Y.count(); i++){
            filtered[i]=0;
            for(int j = 0; j<219; j++){
                if((i-j)>=0){
                    filtered[i]+=filter2[j]*Y[i-j];
                }
            }
        }
        //Sets result as filtered signal
        for(int i = 0; i<X.count(); i++){
            result[n_results][0][i]=i;
            result[n_results][1][i]=filtered[i];
        }
        n_results++;
    }
    
    //Sets number of elements in each ch returning
    n_elements = new int[n_results];
    for(int i = 0; i<n_results; i++){
        n_elements[i] = X.count();
    }
    
    return result;
}

 Q_EXPORT_PLUGIN2(method_fir, FIR_test)